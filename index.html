<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kuesioner RME RSOSR</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f4f4f4;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #333;
            text-align: center;
            line-height: 1.3;
            font-size: 2rem;
            /* contoh */
        }

        h1 .subline {
            display: block;
            font-size: 2rem;
            /* Sesuaikan ukuran jika perlu */
            margin-top: 4px;
            /* Atur jaraknya supaya lebih rapat */
        }

        h2 {
            color: #333;
        }

        .wizard {
            background: #fff;
            padding: 20px 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            display: none;
            max-width: 900px;
            margin: 30px auto;
        }

        .active {
            display: block;
        }

        label {
            margin: 12px 0 6px;
            font-weight: bold;
            display: block;
        }

        input[type="text"],
        input[type="email"],
        select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .choice {
            margin-bottom: 20px;
        }

        .radio-group {
            display: flex;
            gap: 10px;
            overflow-x: auto;
        }

        .radio-group label {
            font-weight: normal;
            white-space: nowrap;
            flex-shrink: 0;
            cursor: pointer;
            padding: 6px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background: #f9f9f9;
            min-width: 100px;
            display: flex;
            align-items: center;
            font-size: clamp(0.7rem, 1.5vw, 1rem);
        }

        input[type="radio"] {
            margin-right: 6px;
            cursor: pointer;
            vertical-align: middle;
        }

        .gender-choice {
            display: flex;
            gap: 40px;
            margin-bottom: 20px;
        }

        .gender-choice label {
            flex: none;
        }

        .buttons {
            margin-top: 30px;
            text-align: center;
        }

        input[type="button"],
        input[type="submit"] {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            margin: 0 10px;
            transition: background-color 0.3s ease;
        }

        input[type="button"]:hover,
        input[type="submit"]:hover {
            background-color: #1e7e34;
        }

        #thankYouMsg {
            max-width: 900px;
            margin: 50px auto;
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 20px;
            font-size: 1.3rem;
            text-align: center;
            display: none;
        }

        /* Responsive: sembunyikan radio di mobile, tampilkan select */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.2rem;
                /* atau lebih kecil */
            }

            h1 .subline {
                font-size: 1.2rem;
                /* atau lebih kecil */
            }
        }

        @media (max-width: 600px) {
            .radio-group {
                display: none;
            }

            .mobile-select {
                display: block !important;
                width: 100%;
                margin-bottom: 15px;
                font-size: 1rem;
                padding: 8px;
            }
        }

        /* Desktop: sembunyikan select, tampilkan radio */
        @media (min-width: 601px) {
            .mobile-select {
                display: none !important;
            }

            .radio-group {
                display: flex;
            }
        }

        /* atur jarak tombol */
        @media (max-width: 600px) {
            .buttons {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }

            .buttons input[type="button"],
            .buttons input[type="submit"] {
                width: 100%;
                margin: 0;
            }
        }

        /* Spinner */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body>
    <h1>KUESIONER ANALISIS PELAKSANAAN REKAM MEDIS ELEKTRONIK DENGAN METODE DELONE AND MCLEAN INFORMATION SYSTEM
        SUCCESS (D&M) <span class="subline">DI RS ORTHOPEDI SIAGA RAYA</span>
    </h1>

    <form id="kuesionerForm" novalidate>
        <!-- Step 1 -->
        <div class="wizard active" id="step1">
            <h2>Informed Consent</h2>
            <label for="kode_responden">Email Responden (untuk kode):</label>
            <input type="email" id="kode_responden" name="kode_responden" placeholder="contoh@domain.com" required />

            <label for="nama_responden">Nama Responden:</label>
            <input type="text" id="nama_responden" name="nama_responden" required />

            <label>Jenis Kelamin:</label>
            <div class="gender-choice">
                <label><input type="radio" name="jenis_kelamin" value="L" required /> Laki-laki</label>
                <label><input type="radio" name="jenis_kelamin" value="P" required /> Perempuan</label>
            </div>

            <label for="usia">Usia:</label>
            <select id="usia" name="usia" required>
                <option value="" disabled selected>Pilih usia</option>
                <option>20 - 30 Tahun</option>
                <option>31-40 Tahun</option>
                <option>41-50 Tahun</option>
                <option>> 50 Tahun</option>

            </select>

            <label for="pendidikan">Pendidikan Terakhir:</label>
            <select id="pendidikan" name="pendidikan" required>
                <option value="" disabled selected>Pilih pendidikan terakhir</option>
                <option>SLTA/Sederajat</option>
                <option>D3</option>
                <option>S1</option>
                <option>S2</option>
                <option>S3</option>
            </select>

            <label for="unit_kerja">Unit Kerja/Jabatan:</label>
            <select id="unit_kerja" name="unit_kerja" required>
                <option value="" disabled selected>Pilih unit kerja</option>
                <option>Dokter</option>
                <option>Manajemen/Direksi</option>
                <option>Perawat & Bidan</option>
                <option>Kasir & TU</option>
                <option>Rekam Medis</option>
                <option>Fisioterapi</option>
                <option>Pendaftaran Rawat Jalan & Admission</option>
                <option>Rontgen/MRI</option>
                <option>Farmasi</option>
                <option>Gizi</option>
                <option>Laboratorium</option>
                <option>IT</option>

            </select>

            <label for="masa_kerja">Masa Kerja:</label>
            <select id="masa_kerja" name="masa_kerja" required>
                <option value="" disabled selected>Pilih Masa Kerja</option>
                <option>0-5 Tahun</option>
                <option>6-10 Tahun</option>
                <option>> 10 Tahun</option>

            </select>
            <div class="buttons">
                <input type="button" value="Selanjutnya" onclick="nextStep(1)" />
            </div>
        </div>

        <!-- Steps 2-5: Kualitas Informasi, Sistem, Layanan, Intensi Memakai -->
        <div class="wizard" id="step2"></div>
        <div class="wizard" id="step3"></div>
        <div class="wizard" id="step4"></div>
        <div class="wizard" id="step5"></div>

        <!-- Step 6: Tingkat Penggunaan Radio + Select -->
        <div class="wizard" id="step6">
            <h2>Tingkat Penggunaan</h2>

            <label>1. Frekuensi anda dalam menggunakan SIM-RS:</label>
            <div class="choice">
                <div class="radio-group" role="radiogroup" aria-label="Frekuensi penggunaan SIM-RS">
                    <label><input type="radio" name="step6_q1" value="Setiap hari" required /> Setiap hari</label>
                    <label><input type="radio" name="step6_q1" value="Tidak setiap hari" /> Tidak setiap hari</label>
                    <label><input type="radio" name="step6_q1" value="Tidak tentu" /> Tidak tentu</label>
                    <label><input type="radio" name="step6_q1" value="Pernah" /> Pernah</label>
                    <label><input type="radio" name="step6_q1" value="Tidak pernah" /> Tidak pernah</label>
                </div>
                <select class="mobile-select" name="step6_q1" required aria-label="Frekuensi penggunaan SIM-RS">
                    <option value="" disabled selected>Pilih frekuensi</option>
                    <option value="Setiap hari">Setiap hari</option>
                    <option value="Tidak setiap hari">Tidak setiap hari</option>
                    <option value="Tidak tentu">Tidak tentu</option>
                    <option value="Pernah">Pernah</option>
                    <option value="Tidak pernah">Tidak pernah</option>
                </select>
            </div>

            <label>2. Lama anda dalam menggunakan SIM-RS dalam satu hari:</label>
            <div class="choice">
                <div class="radio-group" role="radiogroup" aria-label="Lama penggunaan SIM-RS per hari">
                    <label><input type="radio" name="step6_q2" value="Lebih dari 4 jam" required /> Lebih dari 4
                        jam</label>
                    <label><input type="radio" name="step6_q2" value="3–4 jam" /> 3–4 jam</label>
                    <label><input type="radio" name="step6_q2" value="2–3 jam" /> 2–3 jam</label>
                    <label><input type="radio" name="step6_q2" value="1–2 jam" /> 1–2 jam</label>
                    <label><input type="radio" name="step6_q2" value="Kurang dari 1 jam" /> Kurang dari 1 jam</label>
                </div>
                <select class="mobile-select" name="step6_q2" required aria-label="Lama penggunaan SIM-RS per hari">
                    <option value="" disabled selected>Pilih lama penggunaan</option>
                    <option value="Lebih dari 4 jam">Lebih dari 4 jam</option>
                    <option value="3–4 jam">3–4 jam</option>
                    <option value="2–3 jam">2–3 jam</option>
                    <option value="1–2 jam">1–2 jam</option>
                    <option value="Kurang dari 1 jam">Kurang dari 1 jam</option>
                </select>
            </div>

            <label>3. Konsistensi anda dalam menggunakan SIM-RS dalam satu minggu:</label>
            <div class="choice">
                <div class="radio-group" role="radiogroup" aria-label="Konsistensi penggunaan SIM-RS per minggu">
                    <label><input type="radio" name="step6_q3" value="Lebih dari 5 hari" required /> Lebih dari 5
                        hari</label>
                    <label><input type="radio" name="step6_q3" value="4–5 hari" /> 4–5 hari</label>
                    <label><input type="radio" name="step6_q3" value="3–4 hari" /> 3–4 hari</label>
                    <label><input type="radio" name="step6_q3" value="2–3 hari" /> 2–3 hari</label>
                    <label><input type="radio" name="step6_q3" value="Kurang dari 2 hari" /> Kurang dari 2 hari</label>
                </div>
                <select class="mobile-select" name="step6_q3" required
                    aria-label="Konsistensi penggunaan SIM-RS per minggu">
                    <option value="" disabled selected>Pilih konsistensi penggunaan</option>
                    <option value="Lebih dari 5 hari">Lebih dari 5 hari</option>
                    <option value="4–5 hari">4–5 hari</option>
                    <option value="3–4 hari">3–4 hari</option>
                    <option value="2–3 hari">2–3 hari</option>
                    <option value="Kurang dari 2 hari">Kurang dari 2 hari</option>
                </select>
            </div>

            <div class="buttons">
                <input type="button" value="Sebelumnya" onclick="prevStep(6)" />
                <input type="button" value="Selanjutnya" onclick="nextStep(6)" />
            </div>
        </div>

        <div class="wizard" id="step7"></div>
        <div class="wizard" id="step8"></div>

    </form>

    <div id="thankYouMsg">Terima kasih telah mengisi kuesioner!</div>

    <script>
        // Data pertanyaan per step
        const stepsData = {
            step2: {
                title: 'Kualitas Informasi',
                questions: [
                    'Validitas informasi yang anda terima',
                    'Ketepatan waktu informasi yang anda terima',
                    'Kelengkapan informasi yang anda terima',
                    'Kesesuaian informasi dengan ketentuan pihak manajemen rumah sakit',
                    'Ketepatan penyajian informasi yang anda terima'
                ]
            },
            step3: {
                title: 'Kualitas Sistem',
                questions: [
                    'Kemudahan mengoperasikan SIM-RS',
                    'Kecepatan koneksi SIM-RS',
                    'Perihal gangguan SIM-RS',
                    'Pemenuhan kebutuhan dengan SIM-RS',
                    'Keamanan data anda pada SIM-RS'
                ]
            },
            step4: {
                title: 'Kualitas Layanan',
                questions: [
                    'Kinerja pegawai SIM-RS dalam membantu pengguna',
                    'Kemampuan pegawai SIM-RS dalam memperbaiki kekurangan',
                    'Pegawai SIM-RS mengarahkan prosedur kerja',
                    'Pegawai SIM-RS memberikan kepastian layanan',
                    'Pegawai SIM-RS memiliki rasa empati'
                ]
            },
            step5: {
                title: 'Intensi Memakai',
                questions: [
                    'Keinginan anda menggunakan SIM-RS',
                    'Kebutuhan anda terhadap SIM-RS',
                    'Motivasi anda dalam menggunakan SIM-RS',
                    'Komitmen anda dalam menggunakan SIM-RS',
                    'Kerelaan anda dalam menggunakan SIM-RS'
                ]
            },
            step7: {
                title: 'Kepuasan Pengguna',
                questions: [
                    'Pekerjaan menjadi lebih hemat waktu dengan menggunakan SIM-RS',
                    'Pekerjaan menjadi lebih hemat tenaga dengan menggunakan SIM-RS',
                    'Pekerjaan menjadi lebih hemat materi dengan menggunakan SIM-RS',
                    'Capaian anda terhadap tujuan pekerjaan dapat tercapai dengan menggunakan SIM-RS',
                    'Perasaan puas dan pengalaman menyenangkan anda dalam menggunakan SIM-RS',
                    'Perasaan bangga dan peningkatan prestasi kerja setelah menggunakan SIM-RS'
                ]
            },
            step8: {
                title: 'Manfaat Bersih',
                questions: [
                    'Peningkatan pengetahuan anda setelah menggunakan SIM-RS',
                    'Peningkatan kemampuan/soft skill anda setelah menggunakan SIM-RS',
                    'Pengurangan waktu dalam pencarian data pasien',
                    'Peningkatan produktifitas dalam menyelesaikan tugas dengan menggunakan SIM-RS',
                    'Peningkatan pengetahuan anda setelah menggunakan SIM-RS (pertanyaan ulang)',
                    'Peningkatan kemampuan/soft skill anda setelah menggunakan SIM-RS (pertanyaan ulang)'
                ]
            }
        };

        const scaleLabels = [
            "1-Sangat Buruk",
            "2-Buruk",
            "3-Cukup",
            "4-Baik",
            "5-Sangat Baik"
        ];

        // Generate HTML pertanyaan dengan radio dan select
        function generateQuestionsHTML(stepId) {
            const step = stepsData[stepId];
            if (!step) return '';
            let html = `<h2>${step.title}</h2>`;
            step.questions.forEach((q, i) => {
                const name = `${stepId}_q${i+1}`;
                html += `<label>${i+1}. ${q}:</label><div class="choice">`;

                // Radio button group
                html += `<div class="radio-group" role="radiogroup" aria-label="${q}">`;
                scaleLabels.forEach((label, idx) => {
                    html +=
                        `<label><input type="radio" name="${name}" value="${idx+1}" ${idx===0?'required':''} />${label}</label>`;
                });
                html += `</div>`;

                // Select dropdown for mobile
                html += `<select class="mobile-select" name="${name}" aria-label="${q}" required>`;
                html += `<option value="" disabled selected>Pilih nilai</option>`;
                scaleLabels.forEach((label, idx) => {
                    html += `<option value="${idx+1}">${label}</option>`;
                });
                html += `</select>`;
                html += `</div>`;
            });

            // Tombol navigasi
            const stepNum = parseInt(stepId.replace('step', ''), 10);
            html += `<div class="buttons"><input type="button" value="Sebelumnya" onclick="prevStep(${stepNum})" />`;

            if (stepId === 'step8') {
                html += `
                <div style="position: relative; display: inline-block;">
                    <input type="submit" value="Kirim Kuesioner" />
                    <div id="spinner"
                        style="display: none; position: absolute; top: 50%; right: -50px; transform: translateY(-50%);">
                        <div class="loader"></div>
                    </div>
                </div>`;
            } else {
                html += `<input type="button" value="Selanjutnya" onclick="nextStep(${stepNum})" />`;
            }

            html += `</div>`;

            return html;
        }

        // Isi konten step dinamis saat halaman dimuat
        window.addEventListener('DOMContentLoaded', () => {
            Object.keys(stepsData).forEach(stepId => {
                const el = document.getElementById(stepId);
                if (el) {
                    el.innerHTML = generateQuestionsHTML(stepId);
                }
            });

            // Sinkronisasi select dan radio
            syncAllSelectRadio();
        });

        // Sinkronisasi pilihan select dan radio secara umum
        function syncAllSelectRadio() {
            // Untuk setiap select.mobile-select, tambahkan listener untuk update radio
            document.querySelectorAll('select.mobile-select').forEach(select => {
                select.addEventListener('change', e => {
                    const val = select.value;
                    const name = select.name;
                    const radios = document.querySelectorAll(`input[type=radio][name="${name}"]`);
                    radios.forEach(radio => {
                        radio.checked = radio.value === val;
                    });
                });
            });
            // Untuk setiap radio, update select saat radio diganti
            document.querySelectorAll('input[type=radio]').forEach(radio => {
                radio.addEventListener('change', e => {
                    if (radio.checked) {
                        const name = radio.name;
                        const val = radio.value;
                        const select = document.querySelector(`select.mobile-select[name="${name}"]`);
                        if (select) {
                            select.value = val;
                        }
                    }
                });
            });
        }

        // Navigasi langkah berikutnya
        function nextStep(current) {
            const currentStep = document.getElementById(`step${current}`);
            if (!validateStep(currentStep)) return;
            const nextNum = current + 1;
            const nextStep = document.getElementById(`step${nextNum}`);
            if (!nextStep) return;
            currentStep.classList.remove('active');
            nextStep.classList.add('active');
            window.scrollTo(0, 0);
        }

        // Navigasi langkah sebelumnya
        function prevStep(current) {
            const currentStep = document.getElementById(`step${current}`);
            const prevNum = current - 1;
            const prevStep = document.getElementById(`step${prevNum}`);
            if (!prevStep) return;
            currentStep.classList.remove('active');
            prevStep.classList.add('active');
            window.scrollTo(0, 0);
        }

        // Validasi step input required
        function validateStep(stepEl) {
            if (!stepEl) return false;
            // Validasi radio group: set nama unik radio group yang harus terisi
            const requiredRadioNames = new Set();
            stepEl.querySelectorAll('input[type=radio][required]').forEach(input => {
                requiredRadioNames.add(input.name);
            });
            for (let name of requiredRadioNames) {
                // cek apakah salah satu radio dengan name tercentang
                const radios = stepEl.querySelectorAll(`input[type=radio][name="${name}"]`);
                const selected = Array.from(radios).some(r => r.checked);
                // cek select untuk nama yang sama, jika select muncul alias di mobile
                const select = stepEl.querySelector(`select.mobile-select[name="${name}"]`);
                const selectVisible = select && window.getComputedStyle(select).display !== 'none';
                if (!selected) {
                    if (selectVisible) {
                        if (!select.value) {
                            alert('Mohon isi semua pertanyaan pada halaman ini.');
                            select.focus();
                            return false;
                        }
                    } else {
                        alert('Mohon isi semua pertanyaan pada halaman ini.');
                        return false;
                    }
                }
            }
            // Validasi input text/email/select lain
            const inputs = stepEl.querySelectorAll('input[required]:not([type=radio]), select[required]');
            for (let input of inputs) {
                if (!input.value) {
                    alert('Mohon isi semua pertanyaan pada halaman ini.');
                    input.focus();
                    return false;
                }
            }
            return true;
        }

        document.getElementById('kuesionerForm').addEventListener('submit', e => {
            e.preventDefault();

            const form = e.target;
            const spinner = document.getElementById('spinner');

            // 1️⃣ Buat form clone kosong
            const cloneForm = document.createElement('form');

            // 2️⃣ Tambahkan input yang terlihat ke clone
            form.querySelectorAll('input, select').forEach(el => {
                if (window.getComputedStyle(el).display !== 'none' && el.name) {
                    const cloneInput = el.cloneNode(true);
                    cloneInput.value = el.value;
                    if (el.type === 'radio' || el.type === 'checkbox') {
                        if (el.checked) {
                            cloneForm.appendChild(cloneInput);
                        }
                    } else {
                        cloneForm.appendChild(cloneInput);
                    }
                }
            });

            // 3️⃣ Buat FormData dari cloneForm
            const formData = new FormData(cloneForm);

            spinner.style.display = 'block';

            fetch('https://script.google.com/macros/s/AKfycbxIRGCv38gmEM-RVFa6apO5hjEB51RFb7XBL_iUbIymoEhwA0_WBD5jJcws-GWkkoXB/exec', {
                    method: 'POST',
                    mode: 'cors',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(data => {
                    if (data.result === 'success') {
                        alert('Terima kasih telah mengisi kuesioner!');
                        form.reset();
                        document.querySelectorAll('.wizard').forEach(el => el.classList.remove('active'));
                        document.getElementById('step1').classList.add('active');
                        window.scrollTo(0, 0);
                    } else {
                        throw new Error('Response tidak sukses');
                    }
                })
                .catch(error => {
                    alert('Gagal mengirim data. Coba lagi.');
                    console.error('Error saat kirim:', error);
                })
                .finally(() => {
                    spinner.style.display = 'none';
                });
        });
    </script>
</body>

</html>
